generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Admin {
  id           String   @id @default(uuid())
  email        String   @unique
  name         String   @default("") // Keep for backward compatibility
  firstName    String   @default("")
  lastName     String?
  username     String?   @unique
  bio          String?
  urls         Json?     @default("[]") // [{value: string}]
  phoneNumber  String?  @unique

  passwordHash String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  
  // Account Settings
  dob          DateTime?
  language     String?
  
  // Appearance Settings
  theme        String?   @default("light")
  font         String?   @default("inter")
  
  // Display Settings
  displayItems Json?     @default("[\"recents\", \"home\", \"applications\", \"desktop\", \"downloads\", \"documents\"]")
  
  // Notification Settings
  notificationType    String?   @default("all")
  mobileNotifications Boolean?  @default(false)
  communicationEmails Boolean?  @default(false)
  socialEmails        Boolean?  @default(false)
  marketingEmails     Boolean?  @default(false)
  securityEmails      Boolean?  @default(true)

  @@map("admins")

}

model AdminOtp {
  id        String   @id @default(uuid())
  email     String
  codeHash  String
  intent    String
  used      Boolean  @default(false)
  expiresAt DateTime
  createdAt DateTime @default(now())

  @@index([email, intent])
  @@map("admin_otps")
}

model AuthSession {
  id        String   @id
  email     String
  intent    String
  expiresAt DateTime
  createdAt DateTime @default(now())

  @@index([email, intent])
  @@map("auth_sessions")
}

model Invite {
  id        String    @id @default(uuid())
  email     String    @unique
  token     String    @unique
  invitedBy String
  role      String    @default("admin") // Defaulting for migration safety, though should be required
  desc      String?
  expiresAt DateTime
  used      Boolean   @default(false)
  createdAt DateTime  @default(now())
  usedAt    DateTime?

  @@index([email, expiresAt])
  @@index([token])
  @@map("invites")
}
